<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Sternlabs]]></title>
  <link href="https://sternlabs.github.io/atom.xml" rel="self"/>
  <link href="https://sternlabs.github.io/"/>
  <updated>2015-05-03T18:35:43+02:00</updated>
  <id>https://sternlabs.github.io/</id>
  <author>
    <name><![CDATA[Sternlabs]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Simple SWD Adapter]]></title>
    <link href="https://sternlabs.github.io/blog/2014/11/02/simple-swd-adapter/"/>
    <updated>2014-11-02T13:14:10+01:00</updated>
    <id>https://sternlabs.github.io/blog/2014/11/02/simple-swd-adapter</id>
    <content type="html"><![CDATA[
<p>This is the project log of a simple SWD adapter.  Unfortunately there
  are not many easily usable open source SWD adapters out there, and the
  commercial ones are expensive and inconvenient to use.</p>
<p>Let&#8217;s start by defining the requirements.</p>
<h2>Requirements</h2>
<ul>
  <li>small</li>
  <li>cheap</li>
  <li>USB</li>
  <li>ARM core</li>
  <li>hardware accelerated SWD</li>
  <li>UART/SWO support</li>
  <li>hardware accelerated JTAG</li>
</ul>
<h3>MCU selection</h3>
<p>Let&#8217;s select the MCU first.  I already wrote a <a href="https://github.com/mchck/mchck/tree/master/toolchain/lib/usb">USB library</a> for the <a href="https://mchck.org/">MC
  HCK</a>, which is based on a Freescale Kinetis ARM core.  Also, the KL26
  MCUs are available in small (QFN32), and cheap.  It is also easy to
  find, using my favorite component selection strategy: <a href="http://www.digikey.com/product-search/en/integrated-circuits-ics/embedded-microcontrollers/2556109?k%3Darm%2520usb">search for ARM
  MCU microcontrollers on DigiKey</a>, <a href="http://www.digikey.com/product-search/en?FV%3Dfff40027%252Cfff800cd&amp;k%3Darm%2Busb&amp;mnonly%3D0&amp;newproducts%3D0&amp;ColumnSort%3D1000011&amp;page%3D1&amp;stock%3D0&amp;pbfree%3D0&amp;rohs%3D0&amp;quantity%3D100&amp;ptm%3D0&amp;fid%3D0&amp;pageSize%3D25">enter 100 quantity and sort by
  price</a> :).  All discussion forward will reference the <a href="http://cache.freescale.com/files/microcontrollers/doc/ref_manual/KL26P121M48SF4RM.pdf">MKL26ZxxVFM4</a>.</p>
<h2>Design planing</h2>
<p>I have to admit (to myself), that I&#8217;m a bit obsessive, and I keep
  trying to squeeze in functionality as elegantly as possible.  So let&#8217;s
  try it here as well.</p>
<h3>Pin assignments</h3>
<p>I start by reviewing the pin assignments possible.  The Kinetis chips
  do not have a full crossbar, so only specific combinations are
  possible.</p>
<p>Our <a href="http://infocenter.arm.com/help/index.jsp?topic%3D/com.arm.doc.ddi0314h/Chdhbiad.html">standard ARM CoreSight 10 pin SWD/JTAG header</a> will have the following pinout:</p>
<table>
  <tr><th>Pin</th><th>Pin Name</th><th>JTAG</th><th>SWD</th><th>UART</th><th>Peripheral</th></tr>
  <tr><td>1</td><td>VTref</td><td>sense target Vdd</td><td>sense target Vdd</td><td></td><td>analog in</td></tr>
  <tr><td>2</td><td>TMS/SWDIO</td><td>to target, slow</td><td>bidirectional, fast</td><td></td><td>SPI MISO, SPI MOSI</td></tr>
  <tr><td>4</td><td>TCK/SWDCLK</td><td>clock</td><td>clock</td><td></td><td>SPI CLK</td></tr>
  <tr><td>6</td><td>TDO/SWO/UART TX</td><td>data from target</td><td>SWO, optional</td><td>from target</td><td>SPI MISO, UART RX</td></tr>
  <tr><td>8</td><td>TDI/UART RX</td><td>data to target</td><td></td><td>to target</td><td>SPI MOSI, UART TX</td></tr>
  <tr><td>9</td><td>GNDdetect</td><td></td><td></td><td></td><td>open drain</td></tr>
  <tr><td>10</td><td>nRESET</td><td>target reset</td><td>target reset</td><td></td><td>GPIO</td></tr>
</table>
<p>Let&#8217;s start with pins 6 and 8 of the connector: There is a pin on the
  KL26 (PTD6) that can be both SPI MISO (<code>ALT5</code>) and UART RX (<code>ALT3</code>),
  and a pin that goes the other way (PTD7), with SPI MOSI and UART TX.</p>
<p>So, let&#8217;s try this preliminary pin assignment:</p>
<table>
  <tr><th>Adapter Pin</th><th>KL26 Pins</th><th>KL26 Functions</th><th>KL26 QFN32 Pin</th></tr>
  <tr><td>VTref</td><td>PTC2</td><td>ADC0_SE11</td><td>23</td></tr>
  <tr><td>TMS/SWDIO</td><td>PTC6, PTC7</td><td>GPIO, SPI0_MOSI, SPI0_MISO</td><td>27, 28</td></tr>
  <tr><td>TCK/SWDCLK</td><td>PTC5, PTD5</td><td>SPI0_SCK, SPI1_SCK</td><td>26, 30</td></tr>
  <tr><td>TDO/SWO/UART TX</td><td>PTD7</td><td>SPI1_MOSI, UART0_RX</td><td>32</td></tr>
  <tr><td>TDI/UART RX</td><td>PTD6</td><td>SPI1_MISO, UART0_TX</td><td>31</td></tr>
  <tr><td>nRESET</td><td>PTE0</td><td>GPIO</td><td>1</td></tr>
</table>


]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Apple Cake]]></title>
    <link href="https://sternlabs.github.io/blog/2014/10/20/apple-cake/"/>
    <updated>2014-10-20T02:54:32+02:00</updated>
    <id>https://sternlabs.github.io/blog/2014/10/20/apple-cake</id>
    <content type="html"><![CDATA[
<p><img src="https://sternlabs.github.io/images/apple-cake-slice.jpg" alt="/images/apple-cake-slice.jpg" /></p>
<p>Recipe for apple cake.  For a 26cm diameter baking pan.</p>
<!-- more -->
<h2>Crust</h2>
<ul>
  <li>300g flour</li>
  <li>150g butter</li>
  <li>75g sugar</li>
  <li>1 egg</li>
  <li>pinch of salt</li>
</ul>
<p>Mix thoroughly.  Experience shows to best start with sugar + butter,
  then blend in the rest.  The dough will be dry; it should just stick
  together, but crumble apart easily.</p>
<h2>Filling</h2>
<ul>
  <li>750ml apple juice (we juiced apples)</li>
  <li>2 packs <a href="http://www.oetker.de/unsere-produkte/gala/gala-bourbon-vanille.html">vanilla pudding</a></li>
  <li>65g sugar</li>
  <li>some drops of vanilla extract</li>
  <li>5-8 apples (to make 1.8l of filling)</li>
</ul>
<p>Prepare the vanilla pudding with the apple juice instead of milk: mix,
  heat, etc.  Shred/grate apples into small pieces.  Mix the apple
  shreds into the apple vanilla pudding (while still hot).  Add more
  apples if you don&#8217;t have enough filling for your pan.</p>
<h2>Synthesis</h2>
<p>Butter the baking pan, coat with flour or breadcrumbs.  Use
  approx. half of the dough for the bottom, and half for the sides.
  Pull the sides approx. 4cm high.  Now pour the filling into the raw
  crust.  Bake at 160°C for 60 minutes.  Let the cake cool over night.</p>
<h2>Discussion</h2>
<ul>
  <li>The crust came out exactly as I like it.</li>
  <li>It tastes a tad too much puddingy.</li>
</ul>


]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[German Cheesecake]]></title>
    <link href="https://sternlabs.github.io/blog/2014/10/20/german-cheesecake/"/>
    <updated>2014-10-20T01:07:23+02:00</updated>
    <id>https://sternlabs.github.io/blog/2014/10/20/german-cheesecake</id>
    <content type="html"><![CDATA[
<p>Recipe for a German cheesecake using <i>Quark</i>.  For a 26cm diameter baking pan.</p>
<!-- more -->
<h2>Crust</h2>
<ul>
  <li>200g flour</li>
  <li>75g sugar</li>
  <li>60g butter</li>
  <li>7g baking powder</li>
  <li>1 egg</li>
  <li>pinch of salt</li>
</ul>
<p>Mix thoroughly.  Experience shows to best start with sugar + butter,
  then blend in the rest.  The dough will be <i>very</i> dry; it should just
  stick together, but crumble apart easily.</p>
<h2>Filling</h2>
<ul>
  <li>1kg low-fat quark</li>
  <li>400g milk</li>
  <li>90g oil (a small cup)</li>
  <li>200g sugar</li>
  <li>4 eggs</li>
  <li>1 pack <a href="http://www.oetker.de/unsere-produkte/gala/gala-bourbon-vanille.html">vanilla pudding</a></li>
  <li>some drops of vanilla extract</li>
  <li>1 pack of lemon zest</li>
</ul>
<p>Blend all ingredients.  To avoid clumps, mix vanilla pudding and some
  milk separately first.  The filling will be liquid at this stage.</p>
<h2>Synthesis</h2>
<p>Butter the baking pan, coat with flour or breadcrumbs.  Use
  approx. half of the dough for the bottom, and half for the sides.
  Pull the sides approx. 4cm high.  Now pour the filling into the raw
  crust.  Bake at 175°C for 75 minutes; if necessary, cover the top with
  aluminum foil or baking paper to prevent excessive browning.  Let the
  cake cool over night.  Tastes best after a day.</p>
<h2>Discussion</h2>
<ul>
  <li>The dough stretched quite thin first, but in the oven it expanded to the right size.</li>
  <li>The crust came out too poofy for my preferences.</li>
  <li>First day morning, room temperature: I did not quite enjoy the
    texture of the filling.  The texture improved significantly when I
    tried the refrigerated cake in the evening.</li>
</ul>


]]></content>
  </entry>
  
</feed>
